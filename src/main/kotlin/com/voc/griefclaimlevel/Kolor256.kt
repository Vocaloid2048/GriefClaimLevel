/*
 * Created by Voc-夜芷冰 (Vocaloid2048)
 * Copyright © 2025 . All rights reserved.
 */

package com.voc.griefclaimlevel


val ANSI_ESCAPE = "\u001B["
val ANSI_FINISH = "m"

data class Kolor256Setting(
    val foreground: Kolor256? = null,
    val background: Kolor256? = null,
    val fontEffect: List<ANSIFontEffect> = emptyList()
)

fun Kolor256.toHexString(): String {
    return String.format("#%06X", hex)
}

fun String.toXTermString(setting : Kolor256Setting = Kolor256Setting()): String {
    var returnText = ANSI_ESCAPE
    var hasPrefix = false
    if (setting.fontEffect.isNotEmpty()) {
        setting.fontEffect.forEach { 
            returnText += if(!hasPrefix) ANSI_ESCAPE else "" + "${it.code};"
            hasPrefix = true
        }
    }

    if (setting.foreground != null) {
        returnText += if(!hasPrefix) ANSI_ESCAPE else ""+"38;5;${setting.foreground.xTermNumber};"
        hasPrefix = true
    }
    if (setting.background != null) {
        returnText += if(!hasPrefix) ANSI_ESCAPE else ""+"48;5;${setting.background.xTermNumber};"
        hasPrefix = true
    }
    returnText += (ANSI_FINISH + this)

    returnText += (ANSI_ESCAPE + ANSIFontEffect.RESET + ANSI_FINISH)

    return returnText
}

fun strToXTermString(str: String, setting: Kolor256Setting = Kolor256Setting()): String {
    return str.toXTermString(setting)
}

// TL;DR

enum class Kolor256(val xTermNumber: Int, val xTermName: String, val hex: Int) {
    BLACK(0, "BLACK", 0x000000),
    MAROON(1, "MAROON", 0x800000),
    GREEN(2, "GREEN", 0x008000),
    OLIVE(3, "OLIVE", 0x808000),
    NAVY(4, "NAVY", 0x000080),
    PURPLE(5, "PURPLE", 0x800080),
    TEAL(6, "TEAL", 0x008080),
    SILVER(7, "SILVER", 0xC0C0C0),
    GREY(8, "GREY", 0x808080),
    RED(9, "RED", 0xFF0000),
    LIME(10, "LIME", 0x00FF00),
    YELLOW(11, "YELLOW", 0xFFFF00),
    BLUE(12, "BLUE", 0x0000FF),
    FUCHSIA(13, "FUCHSIA", 0xFF00FF),
    AQUA(14, "AQUA", 0x00FFFF),
    WHITE(15, "WHITE", 0xFFFFFF),
    GREY0(16, "GREY0", 0x000000),
    NAVYBLUE(17, "NAVYBLUE", 0x00005F),
    DARKBLUE(18, "DARKBLUE", 0x000087),
    BLUE3(19, "BLUE3", 0x0000AF),
    BLUE3_20(20, "BLUE3_20", 0x0000D7),
    BLUE1(21, "BLUE1", 0x0000FF),
    DARKGREEN(22, "DARKGREEN", 0x005F00),
    DEEPSKYBLUE4(23, "DEEPSKYBLUE4", 0x005F5F),
    DEEPSKYBLUE4_24(24, "DEEPSKYBLUE4_24", 0x005F87),
    DEEPSKYBLUE4_25(25, "DEEPSKYBLUE4_25", 0x005FAF),
    DODGERBLUE3(26, "DODGERBLUE3", 0x005FD7),
    DODGERBLUE2(27, "DODGERBLUE2", 0x005FFF),
    GREEN4(28, "GREEN4", 0x008700),
    SPRINGGREEN4(29, "SPRINGGREEN4", 0x00875F),
    TURQUOISE4(30, "TURQUOISE4", 0x008787),
    DEEPSKYBLUE3(31, "DEEPSKYBLUE3", 0x0087AF),
    DEEPSKYBLUE3_32(32, "DEEPSKYBLUE3_32", 0x0087D7),
    DODGERBLUE1(33, "DODGERBLUE1", 0x0087FF),
    GREEN3(34, "GREEN3", 0x00AF00),
    SPRINGGREEN3(35, "SPRINGGREEN3", 0x00AF5F),
    DARKCYAN(36, "DARKCYAN", 0x00AF87),
    LIGHTSEAGREEN(37, "LIGHTSEAGREEN", 0x00AFAF),
    DEEPSKYBLUE2(38, "DEEPSKYBLUE2", 0x00AFD7),
    DEEPSKYBLUE1(39, "DEEPSKYBLUE1", 0x00AFFF),
    GREEN3_40(40, "GREEN3_40", 0x00D700),
    SPRINGGREEN3_41(41, "SPRINGGREEN3_41", 0x00D75F),
    SPRINGGREEN2(42, "SPRINGGREEN2", 0x00D787),
    CYAN3(43, "CYAN3", 0x00D7AF),
    DARKTURQUOISE(44, "DARKTURQUOISE", 0x00D7D7),
    TURQUOISE2(45, "TURQUOISE2", 0x00D7FF),
    GREEN1(46, "GREEN1", 0x00FF00),
    SPRINGGREEN2_47(47, "SPRINGGREEN2_47", 0x00FF5F),
    SPRINGGREEN1(48, "SPRINGGREEN1", 0x00FF87),
    MEDIUMSPRINGGREEN(49, "MEDIUMSPRINGGREEN", 0x00FFAF),
    CYAN2(50, "CYAN2", 0x00FFD7),
    CYAN1(51, "CYAN1", 0x00FFFF),
    DARKRED(52, "DARKRED", 0x5F0000),
    DEEPPINK4(53, "DEEPPINK4", 0x5F005F),
    PURPLE4(54, "PURPLE4", 0x5F0087),
    PURPLE4_55(55, "PURPLE4_55", 0x5F00AF),
    PURPLE3(56, "PURPLE3", 0x5F00D7),
    BLUEVIOLET(57, "BLUEVIOLET", 0x5F00FF),
    ORANGE4(58, "ORANGE4", 0x5F5F00),
    GREY37(59, "GREY37", 0x5F5F5F),
    MEDIUMPURPLE4(60, "MEDIUMPURPLE4", 0x5F5F87),
    SLATEBLUE3(61, "SLATEBLUE3", 0x5F5FAF),
    SLATEBLUE3_62(62, "SLATEBLUE3_62", 0x5F5FD7),
    ROYALBLUE1(63, "ROYALBLUE1", 0x5F5FFF),
    CHARTREUSE4(64, "CHARTREUSE4", 0x5F8700),
    DARKSEAGREEN4(65, "DARKSEAGREEN4", 0x5F875F),
    PALETURQUOISE4(66, "PALETURQUOISE4", 0x5F8787),
    STEELBLUE(67, "STEELBLUE", 0x5F87AF),
    STEELBLUE3(68, "STEELBLUE3", 0x5F87D7),
    CORNFLOWERBLUE(69, "CORNFLOWERBLUE", 0x5F87FF),
    CHARTREUSE3(70, "CHARTREUSE3", 0x5FAF00),
    DARKSEAGREEN4_71(71, "DARKSEAGREEN4_71", 0x5FAF5F),
    CADETBLUE(72, "CADETBLUE", 0x5FAF87),
    CADETBLUE_73(73, "CADETBLUE_73", 0x5FAFAF),
    SKYBLUE3(74, "SKYBLUE3", 0x5FAFD7),
    STEELBLUE1(75, "STEELBLUE1", 0x5FAFFF),
    CHARTREUSE3_76(76, "CHARTREUSE3_76", 0x5FD700),
    PALEGREEN3(77, "PALEGREEN3", 0x5FD75F),
    SEAGREEN3(78, "SEAGREEN3", 0x5FD787),
    AQUAMARINE3(79, "AQUAMARINE3", 0x5FD7AF),
    MEDIUMTURQUOISE(80, "MEDIUMTURQUOISE", 0x5FD7D7),
    STEELBLUE1_81(81, "STEELBLUE1_81", 0x5FD7FF),
    CHARTREUSE2(82, "CHARTREUSE2", 0x5FFF00),
    SEAGREEN2(83, "SEAGREEN2", 0x5FFF5F),
    SEAGREEN1(84, "SEAGREEN1", 0x5FFF87),
    SEAGREEN1_85(85, "SEAGREEN1_85", 0x5FFFAF),
    AQUAMARINE1(86, "AQUAMARINE1", 0x5FFFD7),
    DARKSLATEGRAY2(87, "DARKSLATEGRAY2", 0x5FFFFF),
    DARKRED_88(88, "DARKRED_88", 0x870000),
    DEEPPINK4_89(89, "DEEPPINK4_89", 0x87005F),
    DARKMAGENTA(90, "DARKMAGENTA", 0x870087),
    DARKMAGENTA_91(91, "DARKMAGENTA_91", 0x8700AF),
    DARKVIOLET(92, "DARKVIOLET", 0x8700D7),
    PURPLE_93(93, "PURPLE_93", 0x8700FF),
    ORANGE4_94(94, "ORANGE4_94", 0x875F00),
    LIGHTPINK4(95, "LIGHTPINK4", 0x875F5F),
    PLUM4(96, "PLUM4", 0x875F87),
    MEDIUMPURPLE3(97, "MEDIUMPURPLE3", 0x875FAF),
    MEDIUMPURPLE3_98(98, "MEDIUMPURPLE3_98", 0x875FD7),
    SLATEBLUE1(99, "SLATEBLUE1", 0x875FFF),
    YELLOW4(100, "YELLOW4", 0x878700),
    WHEAT4(101, "WHEAT4", 0x87875F),
    GREY53(102, "GREY53", 0x878787),
    LIGHTSLATEGREY(103, "LIGHTSLATEGREY", 0x8787AF),
    MEDIUMPURPLE(104, "MEDIUMPURPLE", 0x8787D7),
    LIGHTSLATEBLUE(105, "LIGHTSLATEBLUE", 0x8787FF),
    YELLOW4_106(106, "YELLOW4_106", 0x87AF00),
    DARKOLIVEGREEN3(107, "DARKOLIVEGREEN3", 0x87AF5F),
    DARKSEAGREEN(108, "DARKSEAGREEN", 0x87AF87),
    LIGHTSKYBLUE3(109, "LIGHTSKYBLUE3", 0x87AFAF),
    LIGHTSKYBLUE3_110(110, "LIGHTSKYBLUE3_110", 0x87AFD7),
    SKYBLUE2(111, "SKYBLUE2", 0x87AFFF),
    CHARTREUSE2_112(112, "CHARTREUSE2_112", 0x87D700),
    DARKOLIVEGREEN3_113(113, "DARKOLIVEGREEN3_113", 0x87D75F),
    PALEGREEN3_114(114, "PALEGREEN3_114", 0x87D787),
    DARKSEAGREEN3(115, "DARKSEAGREEN3", 0x87D7AF),
    DARKSLATEGRAY3(116, "DARKSLATEGRAY3", 0x87D7D7),
    SKYBLUE1(117, "SKYBLUE1", 0x87D7FF),
    CHARTREUSE1(118, "CHARTREUSE1", 0x87FF00),
    LIGHTGREEN(119, "LIGHTGREEN", 0x87FF5F),
    LIGHTGREEN_120(120, "LIGHTGREEN_120", 0x87FF87),
    PALEGREEN1(121, "PALEGREEN1", 0x87FFAF),
    AQUAMARINE1_122(122, "AQUAMARINE1_122", 0x87FFD7),
    DARKSLATEGRAY1(123, "DARKSLATEGRAY1", 0x87FFFF),
    RED3(124, "RED3", 0xAF0000),
    DEEPPINK4_125(125, "DEEPPINK4_125", 0xAF005F),
    MEDIUMVIOLETRED(126, "MEDIUMVIOLETRED", 0xAF0087),
    MAGENTA3(127, "MAGENTA3", 0xAF00AF),
    DARKVIOLET_128(128, "DARKVIOLET_128", 0xAF00D7),
    PURPLE_129(129, "PURPLE_129", 0xAF00FF),
    DARKORANGE3(130, "DARKORANGE3", 0xAF5F00),
    INDIANRED(131, "INDIANRED", 0xAF5F5F),
    HOTPINK3(132, "HOTPINK3", 0xAF5F87),
    MEDIUMORCHID3(133, "MEDIUMORCHID3", 0xAF5FAF),
    MEDIUMORCHID(134, "MEDIUMORCHID", 0xAF5FD7),
    MEDIUMPURPLE2(135, "MEDIUMPURPLE2", 0xAF5FFF),
    DARKGOLDENROD(136, "DARKGOLDENROD", 0xAF8700),
    LIGHTSALMON3(137, "LIGHTSALMON3", 0xAF875F),
    ROSYBROWN(138, "ROSYBROWN", 0xAF8787),
    GREY63(139, "GREY63", 0xAF87AF),
    MEDIUMPURPLE2_140(140, "MEDIUMPURPLE2_140", 0xAF87D7),
    MEDIUMPURPLE1(141, "MEDIUMPURPLE1", 0xAF87FF),
    GOLD3(142, "GOLD3", 0xAFAF00),
    DARKKHAKI(143, "DARKKHAKI", 0xAFAF5F),
    NAVAJOWHITE3(144, "NAVAJOWHITE3", 0xAFAF87),
    GREY69(145, "GREY69", 0xAFAFAF),
    LIGHTSTEELBLUE3(146, "LIGHTSTEELBLUE3", 0xAFAFD7),
    LIGHTSTEELBLUE(147, "LIGHTSTEELBLUE", 0xAFAFFF),
    YELLOW3(148, "YELLOW3", 0xAFD700),
    DARKOLIVEGREEN3_149(149, "DARKOLIVEGREEN3_149", 0xAFD75F),
    DARKSEAGREEN3_150(150, "DARKSEAGREEN3_150", 0xAFD787),
    DARKSEAGREEN2(151, "DARKSEAGREEN2", 0xAFD7AF),
    LIGHTCYAN3(152, "LIGHTCYAN3", 0xAFD7D7),
    LIGHTSKYBLUE1(153, "LIGHTSKYBLUE1", 0xAFD7FF),
    GREENYELLOW(154, "GREENYELLOW", 0xAFFF00),
    DARKOLIVEGREEN2(155, "DARKOLIVEGREEN2", 0xAFFF5F),
    PALEGREEN1_156(156, "PALEGREEN1_156", 0xAFFF87),
    DARKSEAGREEN2_157(157, "DARKSEAGREEN2_157", 0xAFFFAF),
    DARKSEAGREEN1(158, "DARKSEAGREEN1", 0xAFFFD7),
    PALETURQUOISE1(159, "PALETURQUOISE1", 0xAFFFFF),
    RED3_160(160, "RED3_160", 0xD70000),
    DEEPPINK3(161, "DEEPPINK3", 0xD7005F),
    DEEPPINK3_162(162, "DEEPPINK3_162", 0xD70087),
    MAGENTA3_163(163, "MAGENTA3_163", 0xD700AF),
    MAGENTA3_164(164, "MAGENTA3_164", 0xD700D7),
    MAGENTA2(165, "MAGENTA2", 0xD700FF),
    DARKORANGE3_166(166, "DARKORANGE3_166", 0xD75F00),
    INDIANRED_167(167, "INDIANRED_167", 0xD75F5F),
    HOTPINK3_168(168, "HOTPINK3_168", 0xD75F87),
    HOTPINK2(169, "HOTPINK2", 0xD75FAF),
    ORCHID(170, "ORCHID", 0xD75FD7),
    MEDIUMORCHID1(171, "MEDIUMORCHID1", 0xD75FFF),
    ORANGE3(172, "ORANGE3", 0xD78700),
    LIGHTSALMON3_173(173, "LIGHTSALMON3_173", 0xD7875F),
    LIGHTPINK3(174, "LIGHTPINK3", 0xD78787),
    PINK3(175, "PINK3", 0xD787AF),
    PLUM3(176, "PLUM3", 0xD787D7),
    VIOLET(177, "VIOLET", 0xD787FF),
    GOLD3_178(178, "GOLD3_178", 0xD7AF00),
    LIGHTGOLDENROD3(179, "LIGHTGOLDENROD3", 0xD7AF5F),
    TAN(180, "TAN", 0xD7AF87),
    MISTYROSE3(181, "MISTYROSE3", 0xD7AFAF),
    THISTLE3(182, "THISTLE3", 0xD7AFD7),
    PLUM2(183, "PLUM2", 0xD7AFFF),
    YELLOW3_184(184, "YELLOW3_184", 0xD7D700),
    KHAKI3(185, "KHAKI3", 0xD7D75F),
    LIGHTGOLDENROD2(186, "LIGHTGOLDENROD2", 0xD7D787),
    LIGHTYELLOW3(187, "LIGHTYELLOW3", 0xD7D7AF),
    GREY84(188, "GREY84", 0xD7D7D7),
    LIGHTSTEELBLUE1(189, "LIGHTSTEELBLUE1", 0xD7D7FF),
    YELLOW2(190, "YELLOW2", 0xD7FF00),
    DARKOLIVEGREEN1(191, "DARKOLIVEGREEN1", 0xD7FF5F),
    DARKOLIVEGREEN1_192(192, "DARKOLIVEGREEN1_192", 0xD7FF87),
    DARKSEAGREEN1_193(193, "DARKSEAGREEN1_193", 0xD7FFAF),
    HONEYDEW2(194, "HONEYDEW2", 0xD7FFD7),
    LIGHTCYAN1(195, "LIGHTCYAN1", 0xD7FFFF),
    RED1(196, "RED1", 0xFF0000),
    DEEPPINK2(197, "DEEPPINK2", 0xFF005F),
    DEEPPINK1(198, "DEEPPINK1", 0xFF0087),
    DEEPPINK1_199(199, "DEEPPINK1_199", 0xFF00AF),
    MAGENTA2_200(200, "MAGENTA2_200", 0xFF00D7),
    MAGENTA1(201, "MAGENTA1", 0xFF00FF),
    ORANGERED1(202, "ORANGERED1", 0xFF5F00),
    INDIANRED1(203, "INDIANRED1", 0xFF5F5F),
    INDIANRED1_204(204, "INDIANRED1_204", 0xFF5F87),
    HOTPINK(205, "HOTPINK", 0xFF5FAF),
    HOTPINK_206(206, "HOTPINK_206", 0xFF5FD7),
    MEDIUMORCHID1_207(207, "MEDIUMORCHID1_207", 0xFF5FFF),
    DARKORANGE(208, "DARKORANGE", 0xFF8700),
    SALMON1(209, "SALMON1", 0xFF875F),
    LIGHTCORAL(210, "LIGHTCORAL", 0xFF8787),
    PALEVIOLETRED1(211, "PALEVIOLETRED1", 0xFF87AF),
    ORCHID2(212, "ORCHID2", 0xFF87D7),
    ORCHID1(213, "ORCHID1", 0xFF87FF),
    ORANGE1(214, "ORANGE1", 0xFFAF00),
    SANDYBROWN(215, "SANDYBROWN", 0xFFAF5F),
    LIGHTSALMON1(216, "LIGHTSALMON1", 0xFFAF87),
    LIGHTPINK1(217, "LIGHTPINK1", 0xFFAFAF),
    PINK1(218, "PINK1", 0xFFAFD7),
    PLUM1(219, "PLUM1", 0xFFAFFF),
    GOLD1(220, "GOLD1", 0xFFD700),
    LIGHTGOLDENROD2_221(221, "LIGHTGOLDENROD2_221", 0xFFD75F),
    LIGHTGOLDENROD2_222(222, "LIGHTGOLDENROD2_222", 0xFFD787),
    NAVAJOWHITE1(223, "NAVAJOWHITE1", 0xFFD7AF),
    MISTYROSE1(224, "MISTYROSE1", 0xFFD7D7),
    THISTLE1(225, "THISTLE1", 0xFFD7FF),
    YELLOW1(226, "YELLOW1", 0xFFFF00),
    LIGHTGOLDENROD1(227, "LIGHTGOLDENROD1", 0xFFFF5F),
    KHAKI1(228, "KHAKI1", 0xFFFF87),
    WHEAT1(229, "WHEAT1", 0xFFFFAF),
    CORNSILK1(230, "CORNSILK1", 0xFFFFD7),
    GREY100(231, "GREY100", 0xFFFFFF),
    GREY3(232, "GREY3", 0x080808),
    GREY7(233, "GREY7", 0x121212),
    GREY11(234, "GREY11", 0x1C1C1C),
    GREY15(235, "GREY15", 0x262626),
    GREY19(236, "GREY19", 0x303030),
    GREY23(237, "GREY23", 0x3A3A3A),
    GREY27(238, "GREY27", 0x444444),
    GREY30(239, "GREY30", 0x4E4E4E),
    GREY35(240, "GREY35", 0x585858),
    GREY39(241, "GREY39", 0x626262),
    GREY42(242, "GREY42", 0x6C6C6C),
    GREY46(243, "GREY46", 0x767676),
    GREY50(244, "GREY50", 0x808080),
    GREY54(245, "GREY54", 0x8A8A8A),
    GREY58(246, "GREY58", 0x949494),
    GREY62(247, "GREY62", 0x9E9E9E),
    GREY66(248, "GREY66", 0xA8A8A8),
    GREY70(249, "GREY70", 0xB2B2B2),
    GREY74(250, "GREY74", 0xBCBCBC),
    GREY78(251, "GREY78", 0xC6C6C6),
    GREY82(252, "GREY82", 0xD0D0D0),
    GREY85(253, "GREY85", 0xDADADA),
    GREY89(254, "GREY89", 0xE4E4E4),
    GREY93(255, "GREY93", 0xEEEEEE),

}

enum class ANSIFontEffect(val code: Int) {
    RESET(0),
    BOLD(1),
    FAINT(2),
    ITALIC(3),
    UNDERLINE(4),
    SLOW_BLINK(5),
    RAPID_BLINK(6),
    REVERSE_VIDEO(7),
    CONCEAL(8),
    CROSSED_OUT(9),
    PRIMARY_FONT(10),
    ALTERNATE_FONT_1(11),
    ALTERNATE_FONT_2(12),
    ALTERNATE_FONT_3(13),
    ALTERNATE_FONT_4(14),
    ALTERNATE_FONT_5(15),
    ALTERNATE_FONT_6(16),
    ALTERNATE_FONT_7(17),
    ALTERNATE_FONT_8(18),
    ALTERNATE_FONT_9(19),
    BOLD_OFF(21),
    DOUBLE_UNDERLINE(22),
    NORMAL_COLOR(22),
    NOT_ITALIC(23),
    NOT_UNDERLINED(24),
    BLINK_OFF(25),
    INVERSE_OFF(27),
    REVEAL(28),
    NOT_CROSSED_OUT(29),
    FRAME(51),
    ENCIRCLE(52),
    OVERLINE(53),
    NOT_FRAME(54),
    NOT_ENCIRCLE(55),
    NOT_OVERLINE(56),
    IDEOGRAM_UNDERLINE(60),
    IDEOGRAM_DOUBLE_UNDERLINE(61),
    IDEOGRAM_OVERLINE(62),
    IDEOGRAM_DOUBLE_OVERLINE(63),
    IDEOGRAM_STRESS_MARKING(64),
    IDEOGRAM_ATTRIBUTES_OFF(65),
}
